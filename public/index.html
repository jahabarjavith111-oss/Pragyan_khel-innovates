<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Smart Auto Focus & Subject Tracking</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="app-container">
        <header class="app-header">
            <div class="logo">
                <svg width="32" height="32" viewBox="0 0 32 32" fill="none">
                    <circle cx="16" cy="16" r="14" stroke="currentColor" stroke-width="2"/>
                    <circle cx="16" cy="16" r="6" fill="currentColor"/>
                    <path d="M16 2v6M16 24v6M2 16h6M24 16h6" stroke="currentColor" stroke-width="2"/>
                </svg>
                <span>SmartFocus AI</span>
            </div>
            <div class="header-stats">
                <div class="stat-item">
                    <span class="stat-label">FPS</span>
                    <span class="stat-value" id="fps-counter">0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Status</span>
                    <span class="stat-value status-text" id="tracking-status">Ready</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Confidence</span>
                    <span class="stat-value" id="confidence-value">--</span>
                </div>
            </div>
        </header>

        <main class="main-content">
            <aside class="control-panel">
                <div class="panel-section">
                    <h3>Input Source</h3>
                    <div class="button-group">
                        <button id="btn-upload" class="btn btn-primary">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                                <polyline points="17 8 12 3 7 8"/>
                                <line x1="12" y1="3" x2="12" y2="15"/>
                            </svg>
                            Upload Video
                        </button>
                        <button id="btn-webcam" class="btn btn-secondary">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M23 7l-7 5 7 5V7z"/>
                                <rect x="1" y="5" width="15" height="14" rx="2" ry="2"/>
                            </svg>
                            Start Webcam
                        </button>
                        <input type="file" id="video-input" accept="video/*" hidden>
                    </div>
                </div>

                <div class="panel-section">
                    <h3>Blur Settings</h3>
                    <div class="slider-control">
                        <label for="blur-intensity">Blur Intensity</label>
                        <input type="range" id="blur-intensity" min="0" max="50" value="20">
                        <span class="slider-value" id="blur-value">20px</span>
                    </div>
                </div>

                <div class="panel-section">
                    <h3>Detection Settings</h3>
                    <div class="slider-control">
                        <label for="detection-interval">Detection Interval</label>
                        <input type="range" id="detection-interval" min="1" max="15" value="5">
                        <span class="slider-value" id="detection-value">5 frames</span>
                    </div>
                    <div class="slider-control">
                        <label for="confidence-threshold">Confidence Threshold</label>
                        <input type="range" id="confidence-threshold" min="0" max="100" value="50">
                        <span class="slider-value" id="confidence-threshold-value">50%</span>
                    </div>
                </div>

                <div class="panel-section">
                    <h3>Tracking</h3>
                    <div class="toggle-group">
                        <label class="toggle">
                            <input type="checkbox" id="enable-tracking" checked>
                            <span class="toggle-slider"></span>
                            <span class="toggle-label">Enable Tracking</span>
                        </label>
                        <label class="toggle">
                            <input type="checkbox" id="enable-segmentation">
                            <span class="toggle-slider"></span>
                            <span class="toggle-label">Enable Segmentation (slower)</span>
                        </label>
                    </div>
                </div>

                <div class="panel-section">
                    <h3>Recording</h3>
                    <div class="button-group">
                        <button id="btn-record" class="btn btn-record">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                <circle cx="12" cy="12" r="8"/>
                            </svg>
                            Start Recording
                        </button>
                        <button id="btn-download" class="btn btn-download" disabled>
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                                <polyline points="7 10 12 15 17 10"/>
                                <line x1="12" y1="15" x2="12" y2="3"/>
                            </svg>
                            Download
                        </button>
                    </div>
                </div>

                <div class="panel-section status-panel">
                    <h3>System Status</h3>
                    <div class="status-list">
                        <div class="status-item" id="status-tf">
                            <span class="status-dot"></span>
                            <span>TensorFlow.js</span>
                        </div>
                        <div class="status-item" id="status-mp">
                            <span class="status-dot"></span>
                            <span>MediaPipe</span>
                        </div>
                        <div class="status-item" id="status-model">
                            <span class="status-dot"></span>
                            <span>COCO-SSD Model</span>
                        </div>
                    </div>
                </div>
            </aside>

            <section class="video-area">
                <div class="canvas-container" id="canvas-container">
                    <canvas id="main-canvas"></canvas>
                    <canvas id="hidden-canvas" hidden></canvas>
                    <div class="canvas-overlay" id="canvas-overlay">
                        <div class="loading-spinner" id="loading-spinner">
                            <div class="spinner"></div>
                            <p id="loading-text">Loading AI models...</p>
                        </div>
                    </div>
                    <div class="click-hint" id="click-hint">
                        Click on a subject to track
                    </div>
                </div>
            </section>
        </main>

        <footer class="app-footer">
            <p>AI Smart Auto Focus - All processing runs locally in your browser</p>
        </footer>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.10.0/dist/tf.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/coco-ssd@2.2.3/dist/coco-ssd.min.js"></script>
    <script src="utils.js"></script>
    <script src="detection.js"></script>
    <script src="tracking.js"></script>
    <script src="segmentation.js"></script>
    <script src="app.js"></script>
</body>
</html>
